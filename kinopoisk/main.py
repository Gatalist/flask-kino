from parser import Processing, list_api_key_1, list_api_key_2


#  if database clear
#  before start first parser need next step
#  add role, add user Admin, add tag popular-actor, run create_popular_actor
# processing.create_popular_actor(file_actor_name='actor/actor.txt', tag_id=1)
# processing.create_popular_actor(file_actor_name='actor/1965.txt', tag_id=2)  # 1965

print("Enter number list key 1 or 2")
number = int(input("\nEnter number: "))
if number == 1:
    list_keys = list_api_key_1
elif number == 2:
    list_keys = list_api_key_2
elif number == 3:
    list_keys = list_api_key_1 + list_api_key_2
else:
    list_keys = []


processing = Processing(list_keys)


#  10 000
# start = int(input("\nEnter number start: "))
# end = int(input("\nEnter number end: "))
# processing.parse_and_create_movie_to_range(start_id=start, end_id=end)


# получаем все идд фильмов кинопоиск_ид
# type_top = 'TOP_250_MOVIES'
# type_top = 'TOP_250_TV_SHOWS'
type_top = 'TOP_POPULAR_MOVIES'
# list_movie = processing.parser_top_movie(type_top=type_top, pages=35)
list_movie = [4968810, 1334852, 4540126, 5275429, 1115471, 5078842, 1346358, 409424, 817167, 5047464, 4413037, 4396438,
              4902648, 1402937, 5047468, 5094888, 4414587, 1311129, 4664634, 1071383, 4413037, 4986329, 4396438,
              4664634, 4902648, 4489198, 4538172, 1143242, 1071383, 5089021, 5454070, 4991138, 5212441, 5360778,
              5117258, 258687, 5304526, 4947994, 81728, 1108577, 1246488, 5094888, 447301, 1257264, 5212571, 5459137,
              535341, 5235707, 81728, 5283168, 5457984, 324, 927898, 5235968, 4421676, 4967684, 1077781, 5080927,
              4959134, 4922959, 1188529, 5325609, 5248892, 4421676, 5277148, 1328346, 4673636, 324, 1392550, 361,
              5138505, 4384109, 726794, 397667, 5212441, 1246488, 4370148, 4477073, 5503483, 1048334, 1318972, 1392550,
              1236605, 4421676, 589290, 49684, 4965334, 14349, 195334, 1013343, 4448519, 5105855, 430519, 370, 4511543,
              413447, 4477073, 1405508, 526, 5089024, 5235275, 4778700, 1267348, 681849, 4507204, 342, 5080927, 5138505,
              5107882, 329, 5249455, 32898, 5248892, 5274398, 5510094, 1311078, 683999, 5089032, 377, 435, 4370148,
              1047883, 111543, 692861, 1044280, 1322324, 900052, 738, 1257264, 689, 1048334, 5447041, 5416511, 848894,
              1134493, 5307156, 4922904, 328, 448, 1217828, 2882, 32898, 2467, 817324, 5447041, 4860116, 377, 819101,
              328, 586397, 1322324, 692861, 5069414, 5212291, 5304526, 4374, 326, 1183582, 1326397, 1044280, 4374,
              1436449, 1183582, 5305423, 4910679, 5047471, 3797, 4966325, 4889667, 4541, 586584, 762738, 530, 586397,
              1343908, 5558, 817324, 1388409, 86326, 577, 588, 478052, 4921783, 1048873, 81733, 959062, 51319, 577,
              5365821, 972745, 5129252, 5398903, 5433889, 1338480, 4926453, 530, 4477074, 4499386, 455194, 406408,
              505898, 1048873, 679486, 9617, 1245524, 1326397, 840821, 455194, 478052, 5492, 5059, 4477067, 7226,
              1236063, 535243, 4991199, 462656, 406408, 1101569, 1264438, 160977, 1198736, 4948328, 462606, 1426925,
              1044002, 5002368, 5005446, 12198, 251733, 839954, 645118, 321842, 5447039, 260162, 474, 5212291, 841081,
              335, 1112132, 301, 5106076, 4368100, 2602, 818981, 977288, 409295, 5129252, 1209777, 677893, 81555,
              4632862, 355, 367, 4987446, 4876740, 12244, 4688, 522876, 572032, 3563, 588, 468994, 959062, 722951,
              535337, 4542208, 1348487, 4477074, 276295, 5009236, 1421591, 770, 4926453, 2561, 688832, 41519, 1309570,
              804662, 718811, 77439, 958722, 1405778, 5503483, 5455274, 590022, 596274, 126196, 819846, 41047, 933307,
              726794, 602675, 4970709, 5233426, 441406, 976636, 1199100, 2213, 42571, 1097478, 807318, 5330291, 920265,
              1345617, 4397602, 1178137, 1219149, 104938, 493992, 1091, 441, 4499408, 669371, 1198811, 432791, 5067763,
              1354524, 476, 4860116, 1283955, 518042, 775273, 381, 841152, 501333, 5095263, 325, 8221, 666, 505851,
              808639, 196604, 1103852, 1229682, 427878, 104992, 6877, 519, 835086, 692865, 571892, 3793, 1338024,
              409372, 1437923, 468581, 428683, 1229684, 5453070, 775276, 977595, 4996, 426004, 195524, 464484, 4921783,
              5118763, 4869021, 555, 1183599, 4485219, 1346564, 5417822, 61237, 1140005, 930534, 1188248, 316376,
              635772, 280172, 453397, 5282216, 944708, 263531, 51319, 590286, 4833824, 81297, 606646, 959606, 61438,
              102838, 4830353, 278522, 4919766, 885349, 46225, 280176, 4917532, 1309596, 645276, 4771048, 4946926,
              988816, 4860001, 7640, 522892, 577488, 1107082, 539, 18973, 5107088, 6006, 65770, 4747499, 838, 75871,
              1325207, 450213, 959365, 2428, 648440, 102245, 5364878, 466, 584405, 5379163, 968031, 161104, 775278,
              1402927, 1265948, 427198, 1263705, 843649, 2656, 484474, 4745702, 81288, 538225, 1000443, 341, 5457596,
              350, 4992369, 5081337, 842493, 432724, 4536580, 61325, 232785, 494, 952158, 5447036, 627, 4571, 2053,
              261127, 843650, 423989, 714248, 4865694, 811078, 77673, 5431548, 4700336, 278273, 5160497, 5420887,
              252641, 89514, 4902649, 1044906, 485311, 517988, 491724, 885658, 405609, 1227997, 467099, 255611, 273302,
              453406, 5376381, 252330, 4926291, 261636, 4769135, 571896, 647671, 6034, 726838, 841700, 495892, 485261,
              673910, 942396, 5450608, 386, 1008113, 45086, 5167, 5421975, 325598, 6764, 958442, 259251, 842950, 395,
              317985, 824437, 47382, 280174, 1073122, 4400203, 4484927, 439650, 409, 992500, 6695, 607737, 444, 4871,
              5460684, 1191022, 470689, 280932, 463724, 371, 403, 854, 5326241, 582101, 437410, 939411, 1446132, 462360,
              1298149, 420923, 4383782, 5000997, 1209527, 280961, 1274271, 6374, 865302, 279102, 523111, 689066, 410,
              495518, 194183, 1114927, 1263902, 1253841, 458, 5306449, 4321512, 2717, 470553, 842033, 817969, 4841224,
              5135249, 834394, 5452636, 1368311, 195563, 468102, 5133406, 470185, 3498, 5425709, 902939, 3442, 1387021,
              78871, 594, 81926, 418762, 5045951, 1219909, 1287544, 1115099, 49166, 4969233, 1140565, 5012, 102510,
              1177510, 968299, 3608, 4878248, 835877, 4718483, 507440, 220617, 4413808, 419200, 976642, 4382259,
              1209193, 106079, 4419497, 32714, 1164908, 378140, 972745, 336, 4920181, 722827, 461939, 8125, 196707,
              925669, 1183578, 47237, 602749, 351, 1355139, 467293, 571, 1991, 760815, 43970, 1228069, 468466, 1032308,
              5362560, 81289, 1008879, 1249233, 4850165, 1138971, 609349, 354, 965936, 1219417, 1379512, 1171976, 5932,
              391772, 5212124, 839818, 693969, 394, 6803, 937438, 4324228, 380, 5096161, 577673, 78240, 966036, 5069414,
              2494, 5024757, 5365821, 572553, 5089025, 522941, 253761, 842227, 807339, 1338502, 102474, 883, 979148,
              281251, 358, 5082134, 278208, 365, 261182, 5394690, 1009784, 931677, 1097391, 5129, 1047881, 840817,
              464282, 742026, 5090, 309, 4987450, 4395987, 78378, 1047626]


# добавляем все фильмы (парсим)
# processing.parse_and_create_movie_to_list(list_kinopoisk_id=list_movie)
# получаем добавленные идд фильмов
top_movie_id = processing.get_idd_from_kinopoisk_idd(list_movie)
# # создаем сегмент с нашими фильмами
processing.create_top_250_movie(table_name='segment_movie', list_id=top_movie_id, tag_id=1)
