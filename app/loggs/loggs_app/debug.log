2023-12-12T18:25:05.668427+0000 - [ERROR] : An error has been caught in function 'dispatch_request', process 'MainProcess' (7), thread 'Thread-3 (process_request_thread)' (140518981891776):
Traceback (most recent call last):

  File "/usr/local/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fcd2a45d940>
    └ <Thread(Thread-3 (process_request_thread), started daemon 140518981891776)>
  File "/usr/local/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fcd2a45d620>
    └ <Thread(Thread-3 (process_request_thread), started daemon 140518981891776)>
  File "/usr/local/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-3 (process_request_thread), started daemon 140518981891776)>
    │    │        │    └ (<socket.socket fd=6, family=2, type=1, proto=0, laddr=('172.20.0.4', 5000), raddr=('172.20.0.1', 38380)>, ('172.20.0.1', 383...
    │    │        └ <Thread(Thread-3 (process_request_thread), started daemon 140518981891776)>
    │    └ <bound method ThreadingMixIn.process_request_thread of <werkzeug.serving.ThreadedWSGIServer object at 0x7fcd2752c8f0>>
    └ <Thread(Thread-3 (process_request_thread), started daemon 140518981891776)>
  File "/usr/local/lib/python3.12/socketserver.py", line 692, in process_request_thread
    self.finish_request(request, client_address)
    │    │              │        └ ('172.20.0.1', 38380)
    │    │              └ <socket.socket fd=6, family=2, type=1, proto=0, laddr=('172.20.0.4', 5000), raddr=('172.20.0.1', 38380)>
    │    └ <function BaseServer.finish_request at 0x7fcd2a45f600>
    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7fcd2752c8f0>
  File "/usr/local/lib/python3.12/socketserver.py", line 362, in finish_request
    self.RequestHandlerClass(request, client_address, self)
    │    │                   │        │               └ <werkzeug.serving.ThreadedWSGIServer object at 0x7fcd2752c8f0>
    │    │                   │        └ ('172.20.0.1', 38380)
    │    │                   └ <socket.socket fd=6, family=2, type=1, proto=0, laddr=('172.20.0.4', 5000), raddr=('172.20.0.1', 38380)>
    │    └ <class 'werkzeug.serving.WSGIRequestHandler'>
    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7fcd2752c8f0>
  File "/usr/local/lib/python3.12/socketserver.py", line 761, in __init__
    self.handle()
    │    └ <function WSGIRequestHandler.handle at 0x7fcd299cb560>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7fcd26b373e0>
  File "/usr/local/lib/python3.12/site-packages/werkzeug/serving.py", line 390, in handle
    super().handle()
  File "/usr/local/lib/python3.12/http/server.py", line 436, in handle
    self.handle_one_request()
    │    └ <function BaseHTTPRequestHandler.handle_one_request at 0x7fcd29aa5a80>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7fcd26b373e0>
  File "/usr/local/lib/python3.12/http/server.py", line 424, in handle_one_request
    method()
    └ <bound method WSGIRequestHandler.run_wsgi of <werkzeug.serving.WSGIRequestHandler object at 0x7fcd26b373e0>>
  File "/usr/local/lib/python3.12/site-packages/werkzeug/serving.py", line 362, in run_wsgi
    execute(self.server.app)
    │       │    │      └ <werkzeug.debug.DebuggedApplication object at 0x7fcd273a3e00>
    │       │    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7fcd2752c8f0>
    │       └ <werkzeug.serving.WSGIRequestHandler object at 0x7fcd26b373e0>
    └ <function WSGIRequestHandler.run_wsgi.<locals>.execute at 0x7fcd26b1fb00>
  File "/usr/local/lib/python3.12/site-packages/werkzeug/serving.py", line 325, in execute
    for data in application_iter:
                └ <generator object DebuggedApplication.debug_application at 0x7fcd278fb350>
  File "/usr/local/lib/python3.12/site-packages/werkzeug/debug/__init__.py", line 330, in debug_application
    app_iter = self.app(environ, start_response)
               │    │   │        └ <function WSGIRequestHandler.run_wsgi.<locals>.start_response at 0x7fcd26b1fa60>
               │    │   └ {'wsgi.version': (1, 0), 'wsgi.url_scheme': 'http', 'wsgi.input': <_io.BufferedReader name=6>, 'wsgi.errors': <_io.TextIOWrap...
               │    └ <Flask 'app'>
               └ <werkzeug.debug.DebuggedApplication object at 0x7fcd273a3e00>
  File "/usr/local/lib/python3.12/site-packages/flask/app.py", line 1478, in __call__
    return self.wsgi_app(environ, start_response)
           │    │        │        └ <function WSGIRequestHandler.run_wsgi.<locals>.start_response at 0x7fcd26b1fa60>
           │    │        └ {'wsgi.version': (1, 0), 'wsgi.url_scheme': 'http', 'wsgi.input': <_io.BufferedReader name=6>, 'wsgi.errors': <_io.TextIOWrap...
           │    └ <function Flask.wsgi_app at 0x7fcd29287380>
           └ <Flask 'app'>
  File "/usr/local/lib/python3.12/site-packages/flask/app.py", line 1455, in wsgi_app
    response = self.full_dispatch_request()
               │    └ <function Flask.full_dispatch_request at 0x7fcd29286ac0>
               └ <Flask 'app'>
  File "/usr/local/lib/python3.12/site-packages/flask/app.py", line 867, in full_dispatch_request
    rv = self.dispatch_request()
         │    └ <function Flask.dispatch_request at 0x7fcd29286a20>
         └ <Flask 'app'>
  File "/usr/local/lib/python3.12/site-packages/flask/app.py", line 852, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           │    │           │    │              │    │            └ {'page': 'wrgf'}
           │    │           │    │              │    └ 'moviesonpage'
           │    │           │    │              └ <Rule '/api/movie/page/<page>' (OPTIONS, GET, HEAD) -> moviesonpage>
           │    │           │    └ {'static': <function Flask.__init__.<locals>.<lambda> at 0x7fcd27d342c0>, 'admin.static': <bound method Blueprint.send_static...
           │    │           └ <Flask 'app'>
           │    └ <function Flask.ensure_sync at 0x7fcd29286ca0>
           └ <Flask 'app'>
  File "/usr/local/lib/python3.12/site-packages/flask_restful/__init__.py", line 489, in wrapper
    resp = resource(*args, **kwargs)
           │         │       └ {'page': 'wrgf'}
           │         └ ()
           └ <function View.as_view.<locals>.view at 0x7fcd275125c0>
  File "/usr/local/lib/python3.12/site-packages/flask/views.py", line 109, in view
    return current_app.ensure_sync(self.dispatch_request)(**kwargs)
           │                       │    │                   └ {'page': 'wrgf'}
           │                       │    └ <function Resource.dispatch_request at 0x7fcd27d3fba0>
           │                       └ <app.movies.routes_api.MoviesOnPage object at 0x7fcd273f3500>
           └ <Flask 'app'>
> File "/usr/local/lib/python3.12/site-packages/flask_restful/__init__.py", line 604, in dispatch_request
    resp = meth(*args, **kwargs)
           │     │       └ {'page': 'wrgf'}
           │     └ ()
           └ <bound method MoviesOnPage.get of <app.movies.routes_api.MoviesOnPage object at 0x7fcd273f3500>>
  File "/usr/local/lib/python3.12/site-packages/flask_apispec/annotations.py", line 122, in wrapped
    return wrapper(*args, **kwargs)
           │        │       └ {'page': 'wrgf'}
           │        └ (<app.movies.routes_api.MoviesOnPage object at 0x7fcd273f3500>,)
           └ <flask_apispec.wrapper.Wrapper object at 0x7fcd26b3b9b0>
  File "/usr/local/lib/python3.12/site-packages/flask_apispec/wrapper.py", line 29, in __call__
    response = self.call_view(*args, **kwargs)
               │    │          │       └ {'page': 'wrgf'}
               │    │          └ (<app.movies.routes_api.MoviesOnPage object at 0x7fcd273f3500>,)
               │    └ <function Wrapper.call_view at 0x7fcd27dbaa20>
               └ <flask_apispec.wrapper.Wrapper object at 0x7fcd26b3b9b0>
  File "/usr/local/lib/python3.12/site-packages/flask_apispec/wrapper.py", line 52, in call_view
    return self.func(*args, **kwargs)
           │    │     │       └ {'page': 'wrgf'}
           │    │     └ (<app.movies.routes_api.MoviesOnPage object at 0x7fcd273f3500>,)
           │    └ <function MoviesOnPage.get at 0x7fcd27668f40>
           └ <flask_apispec.wrapper.Wrapper object at 0x7fcd26b3b9b0>

  File "/home/app/app/movies/routes_api.py", line 37, in get
    obj_page = self.objects_in_page(page=int(page), obj=obj)
               │    │                        │          └ <flask_sqlalchemy.query.Query object at 0x7fcd26b371d0>
               │    │                        └ 'wrgf'
               │    └ <function Mixin.objects_in_page at 0x7fcd27668d60>
               └ <app.movies.routes_api.MoviesOnPage object at 0x7fcd273f3500>

ValueError: invalid literal for int() with base 10: 'wrgf'
2023-12-12T18:31:16.761898+0000 - [ERROR] : An error has been caught in function 'dispatch_request', process 'MainProcess' (12), thread 'Thread-2 (process_request_thread)' (140036108445376):
Traceback (most recent call last):

  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f5cb655c5e0>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f5cb52c9100>
    └ <sqlalchemy.engine.base.Connection object at 0x7f5cb533bb00>
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'id_1': 'svd', 'param_1': 1}
    │      │       └ 'SELECT movie.id AS movie_id, movie.kinopoisk_id AS movie_kinopoisk_id, movie.imdb_id AS movie_imdb_id, movie.name_ru AS movi...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f5cb47a93f0; closed: -1>

psycopg2.errors.InvalidTextRepresentation: invalid input syntax for type integer: "svd"
LINE 3: WHERE movie.id = 'svd' 
                         ^



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/usr/local/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f5cb8385940>
    └ <Thread(Thread-2 (process_request_thread), started daemon 140036108445376)>
  File "/usr/local/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f5cb8385620>
    └ <Thread(Thread-2 (process_request_thread), started daemon 140036108445376)>
  File "/usr/local/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-2 (process_request_thread), started daemon 140036108445376)>
    │    │        │    └ (<socket.socket fd=6, family=2, type=1, proto=0, laddr=('172.20.0.4', 5000), raddr=('172.20.0.1', 38006)>, ('172.20.0.1', 380...
    │    │        └ <Thread(Thread-2 (process_request_thread), started daemon 140036108445376)>
    │    └ <bound method ThreadingMixIn.process_request_thread of <werkzeug.serving.ThreadedWSGIServer object at 0x7f5cb52c8f50>>
    └ <Thread(Thread-2 (process_request_thread), started daemon 140036108445376)>
  File "/usr/local/lib/python3.12/socketserver.py", line 692, in process_request_thread
    self.finish_request(request, client_address)
    │    │              │        └ ('172.20.0.1', 38006)
    │    │              └ <socket.socket fd=6, family=2, type=1, proto=0, laddr=('172.20.0.4', 5000), raddr=('172.20.0.1', 38006)>
    │    └ <function BaseServer.finish_request at 0x7f5cb8387600>
    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7f5cb52c8f50>
  File "/usr/local/lib/python3.12/socketserver.py", line 362, in finish_request
    self.RequestHandlerClass(request, client_address, self)
    │    │                   │        │               └ <werkzeug.serving.ThreadedWSGIServer object at 0x7f5cb52c8f50>
    │    │                   │        └ ('172.20.0.1', 38006)
    │    │                   └ <socket.socket fd=6, family=2, type=1, proto=0, laddr=('172.20.0.4', 5000), raddr=('172.20.0.1', 38006)>
    │    └ <class 'werkzeug.serving.WSGIRequestHandler'>
    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7f5cb52c8f50>
  File "/usr/local/lib/python3.12/socketserver.py", line 761, in __init__
    self.handle()
    │    └ <function WSGIRequestHandler.handle at 0x7f5cb78f7560>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7f5cb533b1a0>
  File "/usr/local/lib/python3.12/site-packages/werkzeug/serving.py", line 390, in handle
    super().handle()
  File "/usr/local/lib/python3.12/http/server.py", line 436, in handle
    self.handle_one_request()
    │    └ <function BaseHTTPRequestHandler.handle_one_request at 0x7f5cb79d1a80>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7f5cb533b1a0>
  File "/usr/local/lib/python3.12/http/server.py", line 424, in handle_one_request
    method()
    └ <bound method WSGIRequestHandler.run_wsgi of <werkzeug.serving.WSGIRequestHandler object at 0x7f5cb533b1a0>>
  File "/usr/local/lib/python3.12/site-packages/werkzeug/serving.py", line 362, in run_wsgi
    execute(self.server.app)
    │       │    │      └ <werkzeug.debug.DebuggedApplication object at 0x7f5cb52ca180>
    │       │    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7f5cb52c8f50>
    │       └ <werkzeug.serving.WSGIRequestHandler object at 0x7f5cb533b1a0>
    └ <function WSGIRequestHandler.run_wsgi.<locals>.execute at 0x7f5cb4735120>
  File "/usr/local/lib/python3.12/site-packages/werkzeug/serving.py", line 325, in execute
    for data in application_iter:
                └ <generator object DebuggedApplication.debug_application at 0x7f5cb5673350>
  File "/usr/local/lib/python3.12/site-packages/werkzeug/debug/__init__.py", line 330, in debug_application
    app_iter = self.app(environ, start_response)
               │    │   │        └ <function WSGIRequestHandler.run_wsgi.<locals>.start_response at 0x7f5cb4735080>
               │    │   └ {'wsgi.version': (1, 0), 'wsgi.url_scheme': 'http', 'wsgi.input': <_io.BufferedReader name=6>, 'wsgi.errors': <_io.TextIOWrap...
               │    └ <Flask 'app'>
               └ <werkzeug.debug.DebuggedApplication object at 0x7f5cb52ca180>
  File "/usr/local/lib/python3.12/site-packages/flask/app.py", line 1478, in __call__
    return self.wsgi_app(environ, start_response)
           │    │        │        └ <function WSGIRequestHandler.run_wsgi.<locals>.start_response at 0x7f5cb4735080>
           │    │        └ {'wsgi.version': (1, 0), 'wsgi.url_scheme': 'http', 'wsgi.input': <_io.BufferedReader name=6>, 'wsgi.errors': <_io.TextIOWrap...
           │    └ <function Flask.wsgi_app at 0x7f5cb71b7380>
           └ <Flask 'app'>
  File "/usr/local/lib/python3.12/site-packages/flask/app.py", line 1455, in wsgi_app
    response = self.full_dispatch_request()
               │    └ <function Flask.full_dispatch_request at 0x7f5cb71b6ac0>
               └ <Flask 'app'>
  File "/usr/local/lib/python3.12/site-packages/flask/app.py", line 867, in full_dispatch_request
    rv = self.dispatch_request()
         │    └ <function Flask.dispatch_request at 0x7f5cb71b6a20>
         └ <Flask 'app'>
  File "/usr/local/lib/python3.12/site-packages/flask/app.py", line 852, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           │    │           │    │              │    │            └ {'id': 'svd'}
           │    │           │    │              │    └ 'moviesdetail'
           │    │           │    │              └ <Rule '/api/movie/id/<id>' (HEAD, GET, OPTIONS) -> moviesdetail>
           │    │           │    └ {'static': <function Flask.__init__.<locals>.<lambda> at 0x7f5cb5c882c0>, 'admin.static': <bound method Blueprint.send_static...
           │    │           └ <Flask 'app'>
           │    └ <function Flask.ensure_sync at 0x7f5cb71b6ca0>
           └ <Flask 'app'>
  File "/usr/local/lib/python3.12/site-packages/flask_restful/__init__.py", line 489, in wrapper
    resp = resource(*args, **kwargs)
           │         │       └ {'id': 'svd'}
           │         └ ()
           └ <function View.as_view.<locals>.view at 0x7f5cb528f600>
  File "/usr/local/lib/python3.12/site-packages/flask/views.py", line 109, in view
    return current_app.ensure_sync(self.dispatch_request)(**kwargs)
           │                       │    │                   └ {'id': 'svd'}
           │                       │    └ <function Resource.dispatch_request at 0x7f5cb5c93ba0>
           │                       └ <app.movies.routes_api.MoviesDetail object at 0x7f5cb5d52f30>
           └ <Flask 'app'>
> File "/usr/local/lib/python3.12/site-packages/flask_restful/__init__.py", line 604, in dispatch_request
    resp = meth(*args, **kwargs)
           │     │       └ {'id': 'svd'}
           │     └ ()
           └ <bound method MoviesDetail.get of <app.movies.routes_api.MoviesDetail object at 0x7f5cb5d52f30>>
  File "/usr/local/lib/python3.12/site-packages/flask_apispec/annotations.py", line 122, in wrapped
    return wrapper(*args, **kwargs)
           │        │       └ {'id': 'svd'}
           │        └ (<app.movies.routes_api.MoviesDetail object at 0x7f5cb5d52f30>,)
           └ <flask_apispec.wrapper.Wrapper object at 0x7f5cb5339190>
  File "/usr/local/lib/python3.12/site-packages/flask_apispec/wrapper.py", line 29, in __call__
    response = self.call_view(*args, **kwargs)
               │    │          │       └ {'id': 'svd'}
               │    │          └ (<app.movies.routes_api.MoviesDetail object at 0x7f5cb5d52f30>,)
               │    └ <function Wrapper.call_view at 0x7f5cb5baaa20>
               └ <flask_apispec.wrapper.Wrapper object at 0x7f5cb5339190>
  File "/usr/local/lib/python3.12/site-packages/flask_apispec/wrapper.py", line 52, in call_view
    return self.func(*args, **kwargs)
           │    │     │       └ {'id': 'svd'}
           │    │     └ (<app.movies.routes_api.MoviesDetail object at 0x7f5cb5d52f30>,)
           │    └ <function MoviesDetail.get at 0x7f5cb55dd440>
           └ <flask_apispec.wrapper.Wrapper object at 0x7f5cb5339190>

  File "/home/app/app/movies/routes_api.py", line 56, in get
    obj = Movie.query.filter_by(id=id).first()
          │     │                  └ 'svd'
          │     └ <flask_sqlalchemy.model._QueryProperty object at 0x7f5cb621e660>
          └ <class 'app.movies.models.Movie'>

  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
           │    └ <function Query.limit at 0x7f5cb6277d80>
           └ <flask_sqlalchemy.query.Query object at 0x7f5cb53396d0>
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
            │                  │    │      │      │    │       └ <function Session.execute at 0x7f5cb61ecae0>
            │                  │    │      │      │    └ <sqlalchemy.orm.session.Session object at 0x7f5cb533b770>
            │                  │    │      │      └ <flask_sqlalchemy.query.Query object at 0x7f5cb533b8c0>
            │                  │    │      └ ~_T
            │                  │    └ <class 'sqlalchemy.engine.result.Result'>
            │                  └ ~_T
            └ typing.Union
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x7f5cb61ec7c0>
           └ <sqlalchemy.orm.session.Session object at 0x7f5cb533b770>
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                   │      │                 └ <classmethod(<function AbstractORMCompileState.orm_execute_statement at 0x7f5cb6462160>)>
                   │      └ <class 'sqlalchemy.orm.context.ORMSelectCompileState'>
                   └ typing.Any
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
             │    └ <function Connection.execute at 0x7f5cb6449940>
             └ <sqlalchemy.engine.base.Connection object at 0x7f5cb533bb00>
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.selectable.Select object at 0x7f5cb52c9580>>
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7f5cb6449c60>
           └ <sqlalchemy.engine.base.Connection object at 0x7f5cb533bb00>
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7f5cb6449e40>
          └ <sqlalchemy.engine.base.Connection object at 0x7f5cb533bb00>
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x7f5cb6449ee0>
           └ <sqlalchemy.engine.base.Connection object at 0x7f5cb533bb00>
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7f5cb644a160>
    └ <sqlalchemy.engine.base.Connection object at 0x7f5cb533bb00>
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ InvalidTextRepresentation('invalid input syntax for type integer: "svd"\nLINE 3: WHERE movie.id = \'svd\' \n                 ...
          │                    │              └ (<class 'psycopg2.errors.InvalidTextRepresentation'>, InvalidTextRepresentation('invalid input syntax for type integer: "svd"...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ DataError('(psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type integer: "svd"\nLINE 3: WHERE movie.id =...
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7f5cb655c5e0>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x7f5cb52c9100>
    └ <sqlalchemy.engine.base.Connection object at 0x7f5cb533bb00>
  File "/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'id_1': 'svd', 'param_1': 1}
    │      │       └ 'SELECT movie.id AS movie_id, movie.kinopoisk_id AS movie_kinopoisk_id, movie.imdb_id AS movie_imdb_id, movie.name_ru AS movi...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f5cb47a93f0; closed: -1>

sqlalchemy.exc.DataError: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type integer: "svd"
LINE 3: WHERE movie.id = 'svd' 
                         ^

[SQL: SELECT movie.id AS movie_id, movie.kinopoisk_id AS movie_kinopoisk_id, movie.imdb_id AS movie_imdb_id, movie.name_ru AS movie_name_ru, movie.name_original AS movie_name_original, movie.poster_url AS movie_poster_url, movie.slug AS movie_slug, movie.rating_kinopoisk_id AS movie_rating_kinopoisk_id, movie.rating_imdb_id AS movie_rating_imdb_id, movie.rating_critics_id AS movie_rating_critics_id, movie.year_id AS movie_year_id, movie.film_length_id AS movie_film_length_id, movie.slogan AS movie_slogan, movie.description AS movie_description, movie.short_description AS movie_short_description, movie.type_video_id AS movie_type_video_id, movie.age_limits_id AS movie_age_limits_id, movie.last_syncs AS movie_last_syncs, movie.segment_id AS movie_segment_id, movie.countries_id AS movie_countries_id, movie.genres_id AS movie_genres_id, movie.director_id AS movie_director_id, movie.creator_id AS movie_creator_id, movie.actor_id AS movie_actor_id, movie.screen_img_id AS movie_screen_img_id, movie.similar_id AS movie_similar_id, movie.trailer_id AS movie_trailer_id, movie.user_id AS movie_user_id, movie.created_on AS movie_created_on, movie.updated_on AS movie_updated_on 
FROM movie 
WHERE movie.id = %(id_1)s 
 LIMIT %(param_1)s]
[parameters: {'id_1': 'svd', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2023-12-23T12:35:12.268472+0000 - [ERROR] : An error has been caught in function 'dispatch_request', process 'MainProcess' (17), thread 'Thread-45 (process_request_thread)' (140231261013696):
Traceback (most recent call last):

  File "/usr/local/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f8a36dfd940>
    └ <Thread(Thread-45 (process_request_thread), started daemon 140231261013696)>
  File "/usr/local/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f8a36dfd620>
    └ <Thread(Thread-45 (process_request_thread), started daemon 140231261013696)>
  File "/usr/local/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-45 (process_request_thread), started daemon 140231261013696)>
    │    │        │    └ (<socket.socket fd=6, family=2, type=1, proto=0, laddr=('172.20.0.4', 5000), raddr=('172.20.0.1', 55948)>, ('172.20.0.1', 559...
    │    │        └ <Thread(Thread-45 (process_request_thread), started daemon 140231261013696)>
    │    └ <bound method ThreadingMixIn.process_request_thread of <werkzeug.serving.ThreadedWSGIServer object at 0x7f8a34879be0>>
    └ <Thread(Thread-45 (process_request_thread), started daemon 140231261013696)>
  File "/usr/local/lib/python3.12/socketserver.py", line 692, in process_request_thread
    self.finish_request(request, client_address)
    │    │              │        └ ('172.20.0.1', 55948)
    │    │              └ <socket.socket fd=6, family=2, type=1, proto=0, laddr=('172.20.0.4', 5000), raddr=('172.20.0.1', 55948)>
    │    └ <function BaseServer.finish_request at 0x7f8a36dff600>
    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7f8a34879be0>
  File "/usr/local/lib/python3.12/socketserver.py", line 362, in finish_request
    self.RequestHandlerClass(request, client_address, self)
    │    │                   │        │               └ <werkzeug.serving.ThreadedWSGIServer object at 0x7f8a34879be0>
    │    │                   │        └ ('172.20.0.1', 55948)
    │    │                   └ <socket.socket fd=6, family=2, type=1, proto=0, laddr=('172.20.0.4', 5000), raddr=('172.20.0.1', 55948)>
    │    └ <class 'werkzeug.serving.WSGIRequestHandler'>
    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7f8a34879be0>
  File "/usr/local/lib/python3.12/socketserver.py", line 761, in __init__
    self.handle()
    │    └ <function WSGIRequestHandler.handle at 0x7f8a3636f560>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7f8a32063ef0>
  File "/usr/local/lib/python3.12/site-packages/werkzeug/serving.py", line 390, in handle
    super().handle()
  File "/usr/local/lib/python3.12/http/server.py", line 436, in handle
    self.handle_one_request()
    │    └ <function BaseHTTPRequestHandler.handle_one_request at 0x7f8a3644da80>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7f8a32063ef0>
  File "/usr/local/lib/python3.12/http/server.py", line 424, in handle_one_request
    method()
    └ <bound method WSGIRequestHandler.run_wsgi of <werkzeug.serving.WSGIRequestHandler object at 0x7f8a32063ef0>>
  File "/usr/local/lib/python3.12/site-packages/werkzeug/serving.py", line 362, in run_wsgi
    execute(self.server.app)
    │       │    │      └ <werkzeug.debug.DebuggedApplication object at 0x7f8a36ebfe30>
    │       │    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7f8a34879be0>
    │       └ <werkzeug.serving.WSGIRequestHandler object at 0x7f8a32063ef0>
    └ <function WSGIRequestHandler.run_wsgi.<locals>.execute at 0x7f8a321d68e0>
  File "/usr/local/lib/python3.12/site-packages/werkzeug/serving.py", line 325, in execute
    for data in application_iter:
                └ <generator object DebuggedApplication.debug_application at 0x7f8a331bf810>
  File "/usr/local/lib/python3.12/site-packages/werkzeug/debug/__init__.py", line 330, in debug_application
    app_iter = self.app(environ, start_response)
               │    │   │        └ <function WSGIRequestHandler.run_wsgi.<locals>.start_response at 0x7f8a32046c00>
               │    │   └ {'wsgi.version': (1, 0), 'wsgi.url_scheme': 'http', 'wsgi.input': <_io.BufferedReader name=6>, 'wsgi.errors': <_io.TextIOWrap...
               │    └ <Flask 'app'>
               └ <werkzeug.debug.DebuggedApplication object at 0x7f8a36ebfe30>
  File "/usr/local/lib/python3.12/site-packages/flask/app.py", line 1478, in __call__
    return self.wsgi_app(environ, start_response)
           │    │        │        └ <function WSGIRequestHandler.run_wsgi.<locals>.start_response at 0x7f8a32046c00>
           │    │        └ {'wsgi.version': (1, 0), 'wsgi.url_scheme': 'http', 'wsgi.input': <_io.BufferedReader name=6>, 'wsgi.errors': <_io.TextIOWrap...
           │    └ <function Flask.wsgi_app at 0x7f8a35c27380>
           └ <Flask 'app'>
  File "/usr/local/lib/python3.12/site-packages/flask/app.py", line 1455, in wsgi_app
    response = self.full_dispatch_request()
               │    └ <function Flask.full_dispatch_request at 0x7f8a35c26ac0>
               └ <Flask 'app'>
  File "/usr/local/lib/python3.12/site-packages/flask/app.py", line 867, in full_dispatch_request
    rv = self.dispatch_request()
         │    └ <function Flask.dispatch_request at 0x7f8a35c26a20>
         └ <Flask 'app'>
  File "/usr/local/lib/python3.12/site-packages/flask/app.py", line 852, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           │    │           │    │              │    │            └ {'slug': '28-the-shawshank-redemption'}
           │    │           │    │              │    └ 'app_movies.movie_detail'
           │    │           │    │              └ <Rule '/film/<slug>' (HEAD, GET, OPTIONS) -> app_movies.movie_detail>
           │    │           │    └ {'static': <function Flask.__init__.<locals>.<lambda> at 0x7f8a346bd300>, 'admin.static': <bound method Blueprint.send_static...
           │    │           └ <Flask 'app'>
           │    └ <function Flask.ensure_sync at 0x7f8a35c26ca0>
           └ <Flask 'app'>
  File "/usr/local/lib/python3.12/site-packages/flask/views.py", line 109, in view
    return current_app.ensure_sync(self.dispatch_request)(**kwargs)
           │                       │    │                   └ {'slug': '28-the-shawshank-redemption'}
           │                       │    └ <function MethodView.dispatch_request at 0x7f8a346abec0>
           │                       └ <app.movies.routes.MovieDetailView object at 0x7f8a320f00b0>
           └ <Flask 'app'>
> File "/usr/local/lib/python3.12/site-packages/flask/views.py", line 190, in dispatch_request
    return current_app.ensure_sync(meth)(**kwargs)
           │                       │       └ {'slug': '28-the-shawshank-redemption'}
           │                       └ <bound method MovieDetailView.get of <app.movies.routes.MovieDetailView object at 0x7f8a320f00b0>>
           └ <Flask 'app'>

  File "/home/app/app/movies/routes.py", line 33, in get
    return render_template('detail_movie.html', movie=movie)
           │                                          └ <Movie 28>
           └ <function render_template at 0x7f8a35c90cc0>

  File "/usr/local/lib/python3.12/site-packages/flask/templating.py", line 152, in render_template
    return _render(app, template, context)
           │       │    │         └ {'movie': <Movie 28>, 'g': <flask.g of 'app'>, 'request': <Request 'http://127.0.0.1:5000/film/28-the-shawshank-redemption' [...
           │       │    └ <Template 'detail_movie.html'>
           │       └ <Flask 'app'>
           └ <function _render at 0x7f8a35d2a3e0>
  File "/usr/local/lib/python3.12/site-packages/flask/templating.py", line 133, in _render
    rv = template.render(context)
         │        │      └ {'movie': <Movie 28>, 'g': <flask.g of 'app'>, 'request': <Request 'http://127.0.0.1:5000/film/28-the-shawshank-redemption' [...
         │        └ <function Template.render at 0x7f8a35cae0c0>
         └ <Template 'detail_movie.html'>
  File "/usr/local/lib/python3.12/site-packages/jinja2/environment.py", line 1301, in render
    self.environment.handle_exception()
    │    │           └ <function Environment.handle_exception at 0x7f8a35cad940>
    │    └ <flask.templating.Environment object at 0x7f8a32506480>
    └ <Template 'detail_movie.html'>
  File "/usr/local/lib/python3.12/site-packages/jinja2/environment.py", line 936, in handle_exception
    raise rewrite_traceback_stack(source=source)
          │                              └ None
          └ <function rewrite_traceback_stack at 0x7f8a30781e40>
  File "/home/app/app/templates/detail_movie.html", line 1, in top-level template code
    {% extends 'base.html' %}
  File "/home/app/app/templates/base.html", line 33, in top-level template code
    {% block content %}
  File "/home/app/app/templates/detail_movie.html", line 163, in block 'content'
    {% for mov_similar in movie.get_similar_movie %}
                          │     └ <property object at 0x7f8a32d187c0>
                          └ <Movie 28>
  File "/usr/local/lib/python3.12/site-packages/jinja2/environment.py", line 485, in getattr
    return getattr(obj, attribute)
                   │    └ 'get_similar_movie'
                   └ <Movie 28>

  File "/home/app/app/movies/models_method.py", line 80, in get_similar_movie
    filtered_movies = Movie.query.filter(Movie.kinopoisk_id.in_(similar_values)).all()
                                                                └ [435, 336, 258048, 468958, 4525, 10851, 463686]

NameError: name 'Movie' is not defined
2023-12-23T12:35:58.020514+0000 - [ERROR] : An error has been caught in function 'dispatch_request', process 'MainProcess' (7), thread 'Thread-2 (process_request_thread)' (140150871942848):
Traceback (most recent call last):

  File "/usr/local/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f777058d940>
    └ <Thread(Thread-2 (process_request_thread), started daemon 140150871942848)>
  File "/usr/local/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f777058d620>
    └ <Thread(Thread-2 (process_request_thread), started daemon 140150871942848)>
  File "/usr/local/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-2 (process_request_thread), started daemon 140150871942848)>
    │    │        │    └ (<socket.socket fd=6, family=2, type=1, proto=0, laddr=('172.20.0.4', 5000), raddr=('172.20.0.1', 50592)>, ('172.20.0.1', 505...
    │    │        └ <Thread(Thread-2 (process_request_thread), started daemon 140150871942848)>
    │    └ <bound method ThreadingMixIn.process_request_thread of <werkzeug.serving.ThreadedWSGIServer object at 0x7f777064f890>>
    └ <Thread(Thread-2 (process_request_thread), started daemon 140150871942848)>
  File "/usr/local/lib/python3.12/socketserver.py", line 692, in process_request_thread
    self.finish_request(request, client_address)
    │    │              │        └ ('172.20.0.1', 50592)
    │    │              └ <socket.socket fd=6, family=2, type=1, proto=0, laddr=('172.20.0.4', 5000), raddr=('172.20.0.1', 50592)>
    │    └ <function BaseServer.finish_request at 0x7f777058f600>
    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7f777064f890>
  File "/usr/local/lib/python3.12/socketserver.py", line 362, in finish_request
    self.RequestHandlerClass(request, client_address, self)
    │    │                   │        │               └ <werkzeug.serving.ThreadedWSGIServer object at 0x7f777064f890>
    │    │                   │        └ ('172.20.0.1', 50592)
    │    │                   └ <socket.socket fd=6, family=2, type=1, proto=0, laddr=('172.20.0.4', 5000), raddr=('172.20.0.1', 50592)>
    │    └ <class 'werkzeug.serving.WSGIRequestHandler'>
    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7f777064f890>
  File "/usr/local/lib/python3.12/socketserver.py", line 761, in __init__
    self.handle()
    │    └ <function WSGIRequestHandler.handle at 0x7f776faff560>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7f776b8e5040>
  File "/usr/local/lib/python3.12/site-packages/werkzeug/serving.py", line 390, in handle
    super().handle()
  File "/usr/local/lib/python3.12/http/server.py", line 436, in handle
    self.handle_one_request()
    │    └ <function BaseHTTPRequestHandler.handle_one_request at 0x7f776fbdda80>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7f776b8e5040>
  File "/usr/local/lib/python3.12/http/server.py", line 424, in handle_one_request
    method()
    └ <bound method WSGIRequestHandler.run_wsgi of <werkzeug.serving.WSGIRequestHandler object at 0x7f776b8e5040>>
  File "/usr/local/lib/python3.12/site-packages/werkzeug/serving.py", line 362, in run_wsgi
    execute(self.server.app)
    │       │    │      └ <werkzeug.debug.DebuggedApplication object at 0x7f777061a8d0>
    │       │    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7f777064f890>
    │       └ <werkzeug.serving.WSGIRequestHandler object at 0x7f776b8e5040>
    └ <function WSGIRequestHandler.run_wsgi.<locals>.execute at 0x7f776b8ceac0>
  File "/usr/local/lib/python3.12/site-packages/werkzeug/serving.py", line 325, in execute
    for data in application_iter:
                └ <generator object DebuggedApplication.debug_application at 0x7f776c5bb810>
  File "/usr/local/lib/python3.12/site-packages/werkzeug/debug/__init__.py", line 330, in debug_application
    app_iter = self.app(environ, start_response)
               │    │   │        └ <function WSGIRequestHandler.run_wsgi.<locals>.start_response at 0x7f776b8cea20>
               │    │   └ {'wsgi.version': (1, 0), 'wsgi.url_scheme': 'http', 'wsgi.input': <_io.BufferedReader name=6>, 'wsgi.errors': <_io.TextIOWrap...
               │    └ <Flask 'app'>
               └ <werkzeug.debug.DebuggedApplication object at 0x7f777061a8d0>
  File "/usr/local/lib/python3.12/site-packages/flask/app.py", line 1478, in __call__
    return self.wsgi_app(environ, start_response)
           │    │        │        └ <function WSGIRequestHandler.run_wsgi.<locals>.start_response at 0x7f776b8cea20>
           │    │        └ {'wsgi.version': (1, 0), 'wsgi.url_scheme': 'http', 'wsgi.input': <_io.BufferedReader name=6>, 'wsgi.errors': <_io.TextIOWrap...
           │    └ <function Flask.wsgi_app at 0x7f776f3b7380>
           └ <Flask 'app'>
  File "/usr/local/lib/python3.12/site-packages/flask/app.py", line 1455, in wsgi_app
    response = self.full_dispatch_request()
               │    └ <function Flask.full_dispatch_request at 0x7f776f3b6ac0>
               └ <Flask 'app'>
  File "/usr/local/lib/python3.12/site-packages/flask/app.py", line 867, in full_dispatch_request
    rv = self.dispatch_request()
         │    └ <function Flask.dispatch_request at 0x7f776f3b6a20>
         └ <Flask 'app'>
  File "/usr/local/lib/python3.12/site-packages/flask/app.py", line 852, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           │    │           │    │              │    │            └ {'slug': '28-the-shawshank-redemption'}
           │    │           │    │              │    └ 'app_movies.movie_detail'
           │    │           │    │              └ <Rule '/film/<slug>' (GET, HEAD, OPTIONS) -> app_movies.movie_detail>
           │    │           │    └ {'static': <function Flask.__init__.<locals>.<lambda> at 0x7f776de4d300>, 'admin.static': <bound method Blueprint.send_static...
           │    │           └ <Flask 'app'>
           │    └ <function Flask.ensure_sync at 0x7f776f3b6ca0>
           └ <Flask 'app'>
  File "/usr/local/lib/python3.12/site-packages/flask/views.py", line 109, in view
    return current_app.ensure_sync(self.dispatch_request)(**kwargs)
           │                       │    │                   └ {'slug': '28-the-shawshank-redemption'}
           │                       │    └ <function MethodView.dispatch_request at 0x7f776de3bec0>
           │                       └ <app.movies.routes.MovieDetailView object at 0x7f776b8b2210>
           └ <Flask 'app'>
> File "/usr/local/lib/python3.12/site-packages/flask/views.py", line 190, in dispatch_request
    return current_app.ensure_sync(meth)(**kwargs)
           │                       │       └ {'slug': '28-the-shawshank-redemption'}
           │                       └ <bound method MovieDetailView.get of <app.movies.routes.MovieDetailView object at 0x7f776b8b2210>>
           └ <Flask 'app'>

  File "/home/app/app/movies/routes.py", line 33, in get
    return render_template('detail_movie.html', movie=movie)
           │                                          └ <Movie 28>
           └ <function render_template at 0x7f776f420cc0>

  File "/usr/local/lib/python3.12/site-packages/flask/templating.py", line 152, in render_template
    return _render(app, template, context)
           │       │    │         └ {'movie': <Movie 28>, 'g': <flask.g of 'app'>, 'request': <Request 'http://127.0.0.1:5000/film/28-the-shawshank-redemption' [...
           │       │    └ <Template 'detail_movie.html'>
           │       └ <Flask 'app'>
           └ <function _render at 0x7f776f4ba3e0>
  File "/usr/local/lib/python3.12/site-packages/flask/templating.py", line 133, in _render
    rv = template.render(context)
         │        │      └ {'movie': <Movie 28>, 'g': <flask.g of 'app'>, 'request': <Request 'http://127.0.0.1:5000/film/28-the-shawshank-redemption' [...
         │        └ <function Template.render at 0x7f776f43e0c0>
         └ <Template 'detail_movie.html'>
  File "/usr/local/lib/python3.12/site-packages/jinja2/environment.py", line 1301, in render
    self.environment.handle_exception()
    │    │           └ <function Environment.handle_exception at 0x7f776f43d940>
    │    └ <flask.templating.Environment object at 0x7f776e0e3b00>
    └ <Template 'detail_movie.html'>
  File "/usr/local/lib/python3.12/site-packages/jinja2/environment.py", line 936, in handle_exception
    raise rewrite_traceback_stack(source=source)
          │                              └ None
          └ <function rewrite_traceback_stack at 0x7f776b7dc7c0>
  File "/home/app/app/templates/detail_movie.html", line 1, in top-level template code
    {% extends 'base.html' %}
  File "/home/app/app/templates/base.html", line 33, in top-level template code
    {% block content %}
  File "/home/app/app/templates/detail_movie.html", line 163, in block 'content'
    {% for mov_similar in movie.get_similar_movie %}
                          │     └ <property object at 0x7f776c114c70>
                          └ <Movie 28>
  File "/usr/local/lib/python3.12/site-packages/jinja2/environment.py", line 485, in getattr
    return getattr(obj, attribute)
                   │    └ 'get_similar_movie'
                   └ <Movie 28>

  File "/home/app/app/movies/models_method.py", line 80, in get_similar_movie
    filtered_movies = Movie.query.filter(Movie.kinopoisk_id.in_(similar_values)).all()
                                                                └ [435, 336, 258048, 468958, 4525, 10851, 463686]

NameError: name 'Movie' is not defined
2023-12-23T12:37:42.029838+0000 - [ERROR] : An error has been caught in function 'dispatch_request', process 'MainProcess' (7), thread 'Thread-7 (process_request_thread)' (140150871942848):
Traceback (most recent call last):

  File "/usr/local/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f777058d940>
    └ <Thread(Thread-7 (process_request_thread), started daemon 140150871942848)>
  File "/usr/local/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f777058d620>
    └ <Thread(Thread-7 (process_request_thread), started daemon 140150871942848)>
  File "/usr/local/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-7 (process_request_thread), started daemon 140150871942848)>
    │    │        │    └ (<socket.socket fd=6, family=2, type=1, proto=0, laddr=('172.20.0.4', 5000), raddr=('172.20.0.1', 59168)>, ('172.20.0.1', 591...
    │    │        └ <Thread(Thread-7 (process_request_thread), started daemon 140150871942848)>
    │    └ <bound method ThreadingMixIn.process_request_thread of <werkzeug.serving.ThreadedWSGIServer object at 0x7f777064f890>>
    └ <Thread(Thread-7 (process_request_thread), started daemon 140150871942848)>
  File "/usr/local/lib/python3.12/socketserver.py", line 692, in process_request_thread
    self.finish_request(request, client_address)
    │    │              │        └ ('172.20.0.1', 59168)
    │    │              └ <socket.socket fd=6, family=2, type=1, proto=0, laddr=('172.20.0.4', 5000), raddr=('172.20.0.1', 59168)>
    │    └ <function BaseServer.finish_request at 0x7f777058f600>
    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7f777064f890>
  File "/usr/local/lib/python3.12/socketserver.py", line 362, in finish_request
    self.RequestHandlerClass(request, client_address, self)
    │    │                   │        │               └ <werkzeug.serving.ThreadedWSGIServer object at 0x7f777064f890>
    │    │                   │        └ ('172.20.0.1', 59168)
    │    │                   └ <socket.socket fd=6, family=2, type=1, proto=0, laddr=('172.20.0.4', 5000), raddr=('172.20.0.1', 59168)>
    │    └ <class 'werkzeug.serving.WSGIRequestHandler'>
    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7f777064f890>
  File "/usr/local/lib/python3.12/socketserver.py", line 761, in __init__
    self.handle()
    │    └ <function WSGIRequestHandler.handle at 0x7f776faff560>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7f776b8e4a40>
  File "/usr/local/lib/python3.12/site-packages/werkzeug/serving.py", line 390, in handle
    super().handle()
  File "/usr/local/lib/python3.12/http/server.py", line 436, in handle
    self.handle_one_request()
    │    └ <function BaseHTTPRequestHandler.handle_one_request at 0x7f776fbdda80>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7f776b8e4a40>
  File "/usr/local/lib/python3.12/http/server.py", line 424, in handle_one_request
    method()
    └ <bound method WSGIRequestHandler.run_wsgi of <werkzeug.serving.WSGIRequestHandler object at 0x7f776b8e4a40>>
  File "/usr/local/lib/python3.12/site-packages/werkzeug/serving.py", line 362, in run_wsgi
    execute(self.server.app)
    │       │    │      └ <werkzeug.debug.DebuggedApplication object at 0x7f777061a8d0>
    │       │    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7f777064f890>
    │       └ <werkzeug.serving.WSGIRequestHandler object at 0x7f776b8e4a40>
    └ <function WSGIRequestHandler.run_wsgi.<locals>.execute at 0x7f776b7dcf40>
  File "/usr/local/lib/python3.12/site-packages/werkzeug/serving.py", line 325, in execute
    for data in application_iter:
                └ <generator object DebuggedApplication.debug_application at 0x7f776b725b90>
  File "/usr/local/lib/python3.12/site-packages/werkzeug/debug/__init__.py", line 330, in debug_application
    app_iter = self.app(environ, start_response)
               │    │   │        └ <function WSGIRequestHandler.run_wsgi.<locals>.start_response at 0x7f776b740860>
               │    │   └ {'wsgi.version': (1, 0), 'wsgi.url_scheme': 'http', 'wsgi.input': <_io.BufferedReader name=6>, 'wsgi.errors': <_io.TextIOWrap...
               │    └ <Flask 'app'>
               └ <werkzeug.debug.DebuggedApplication object at 0x7f777061a8d0>
  File "/usr/local/lib/python3.12/site-packages/flask/app.py", line 1478, in __call__
    return self.wsgi_app(environ, start_response)
           │    │        │        └ <function WSGIRequestHandler.run_wsgi.<locals>.start_response at 0x7f776b740860>
           │    │        └ {'wsgi.version': (1, 0), 'wsgi.url_scheme': 'http', 'wsgi.input': <_io.BufferedReader name=6>, 'wsgi.errors': <_io.TextIOWrap...
           │    └ <function Flask.wsgi_app at 0x7f776f3b7380>
           └ <Flask 'app'>
  File "/usr/local/lib/python3.12/site-packages/flask/app.py", line 1455, in wsgi_app
    response = self.full_dispatch_request()
               │    └ <function Flask.full_dispatch_request at 0x7f776f3b6ac0>
               └ <Flask 'app'>
  File "/usr/local/lib/python3.12/site-packages/flask/app.py", line 867, in full_dispatch_request
    rv = self.dispatch_request()
         │    └ <function Flask.dispatch_request at 0x7f776f3b6a20>
         └ <Flask 'app'>
  File "/usr/local/lib/python3.12/site-packages/flask/app.py", line 852, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           │    │           │    │              │    │            └ {'slug': '28-the-shawshank-redemption'}
           │    │           │    │              │    └ 'app_movies.movie_detail'
           │    │           │    │              └ <Rule '/film/<slug>' (GET, HEAD, OPTIONS) -> app_movies.movie_detail>
           │    │           │    └ {'static': <function Flask.__init__.<locals>.<lambda> at 0x7f776de4d300>, 'admin.static': <bound method Blueprint.send_static...
           │    │           └ <Flask 'app'>
           │    └ <function Flask.ensure_sync at 0x7f776f3b6ca0>
           └ <Flask 'app'>
  File "/usr/local/lib/python3.12/site-packages/flask/views.py", line 109, in view
    return current_app.ensure_sync(self.dispatch_request)(**kwargs)
           │                       │    │                   └ {'slug': '28-the-shawshank-redemption'}
           │                       │    └ <function MethodView.dispatch_request at 0x7f776de3bec0>
           │                       └ <app.movies.routes.MovieDetailView object at 0x7f776b8e4200>
           └ <Flask 'app'>
> File "/usr/local/lib/python3.12/site-packages/flask/views.py", line 190, in dispatch_request
    return current_app.ensure_sync(meth)(**kwargs)
           │                       │       └ {'slug': '28-the-shawshank-redemption'}
           │                       └ <bound method MovieDetailView.get of <app.movies.routes.MovieDetailView object at 0x7f776b8e4200>>
           └ <Flask 'app'>

  File "/home/app/app/movies/routes.py", line 33, in get
    return render_template('detail_movie.html', movie=movie)
           │                                          └ <Movie 28>
           └ <function render_template at 0x7f776f420cc0>

  File "/usr/local/lib/python3.12/site-packages/flask/templating.py", line 152, in render_template
    return _render(app, template, context)
           │       │    │         └ {'movie': <Movie 28>, 'g': <flask.g of 'app'>, 'request': <Request 'http://127.0.0.1:5000/film/28-the-shawshank-redemption' [...
           │       │    └ <Template 'detail_movie.html'>
           │       └ <Flask 'app'>
           └ <function _render at 0x7f776f4ba3e0>
  File "/usr/local/lib/python3.12/site-packages/flask/templating.py", line 133, in _render
    rv = template.render(context)
         │        │      └ {'movie': <Movie 28>, 'g': <flask.g of 'app'>, 'request': <Request 'http://127.0.0.1:5000/film/28-the-shawshank-redemption' [...
         │        └ <function Template.render at 0x7f776f43e0c0>
         └ <Template 'detail_movie.html'>
  File "/usr/local/lib/python3.12/site-packages/jinja2/environment.py", line 1301, in render
    self.environment.handle_exception()
    │    │           └ <function Environment.handle_exception at 0x7f776f43d940>
    │    └ <flask.templating.Environment object at 0x7f776e0e3b00>
    └ <Template 'detail_movie.html'>
  File "/usr/local/lib/python3.12/site-packages/jinja2/environment.py", line 936, in handle_exception
    raise rewrite_traceback_stack(source=source)
          │                              └ None
          └ <function rewrite_traceback_stack at 0x7f776b7dc7c0>
  File "/home/app/app/templates/detail_movie.html", line 1, in top-level template code
    {% extends 'base.html' %}
  File "/home/app/app/templates/base.html", line 33, in top-level template code
    {% block content %}
  File "/home/app/app/templates/detail_movie.html", line 163, in block 'content'
    {% for mov_similar in movie.get_similar_movie %}
                          │     └ <property object at 0x7f776c114c70>
                          └ <Movie 28>
  File "/usr/local/lib/python3.12/site-packages/jinja2/environment.py", line 485, in getattr
    return getattr(obj, attribute)
                   │    └ 'get_similar_movie'
                   └ <Movie 28>

  File "/home/app/app/movies/models_method.py", line 80, in get_similar_movie
    filtered_movies = Movie.query.filter(Movie.kinopoisk_id.in_(similar_values)).all()
                                                                └ [435, 336, 258048, 468958, 4525, 10851, 463686]

NameError: name 'Movie' is not defined
2023-12-23T12:37:44.474632+0000 - [ERROR] : An error has been caught in function 'dispatch_request', process 'MainProcess' (7), thread 'Thread-13 (process_request_thread)' (140150871942848):
Traceback (most recent call last):

  File "/usr/local/lib/python3.12/threading.py", line 1009, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f777058d940>
    └ <Thread(Thread-13 (process_request_thread), started daemon 140150871942848)>
  File "/usr/local/lib/python3.12/threading.py", line 1052, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f777058d620>
    └ <Thread(Thread-13 (process_request_thread), started daemon 140150871942848)>
  File "/usr/local/lib/python3.12/threading.py", line 989, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-13 (process_request_thread), started daemon 140150871942848)>
    │    │        │    └ (<socket.socket fd=7, family=2, type=1, proto=0, laddr=('172.20.0.4', 5000), raddr=('172.20.0.1', 59226)>, ('172.20.0.1', 592...
    │    │        └ <Thread(Thread-13 (process_request_thread), started daemon 140150871942848)>
    │    └ <bound method ThreadingMixIn.process_request_thread of <werkzeug.serving.ThreadedWSGIServer object at 0x7f777064f890>>
    └ <Thread(Thread-13 (process_request_thread), started daemon 140150871942848)>
  File "/usr/local/lib/python3.12/socketserver.py", line 692, in process_request_thread
    self.finish_request(request, client_address)
    │    │              │        └ ('172.20.0.1', 59226)
    │    │              └ <socket.socket fd=7, family=2, type=1, proto=0, laddr=('172.20.0.4', 5000), raddr=('172.20.0.1', 59226)>
    │    └ <function BaseServer.finish_request at 0x7f777058f600>
    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7f777064f890>
  File "/usr/local/lib/python3.12/socketserver.py", line 362, in finish_request
    self.RequestHandlerClass(request, client_address, self)
    │    │                   │        │               └ <werkzeug.serving.ThreadedWSGIServer object at 0x7f777064f890>
    │    │                   │        └ ('172.20.0.1', 59226)
    │    │                   └ <socket.socket fd=7, family=2, type=1, proto=0, laddr=('172.20.0.4', 5000), raddr=('172.20.0.1', 59226)>
    │    └ <class 'werkzeug.serving.WSGIRequestHandler'>
    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7f777064f890>
  File "/usr/local/lib/python3.12/socketserver.py", line 761, in __init__
    self.handle()
    │    └ <function WSGIRequestHandler.handle at 0x7f776faff560>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7f776b7e8320>
  File "/usr/local/lib/python3.12/site-packages/werkzeug/serving.py", line 390, in handle
    super().handle()
  File "/usr/local/lib/python3.12/http/server.py", line 436, in handle
    self.handle_one_request()
    │    └ <function BaseHTTPRequestHandler.handle_one_request at 0x7f776fbdda80>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7f776b7e8320>
  File "/usr/local/lib/python3.12/http/server.py", line 424, in handle_one_request
    method()
    └ <bound method WSGIRequestHandler.run_wsgi of <werkzeug.serving.WSGIRequestHandler object at 0x7f776b7e8320>>
  File "/usr/local/lib/python3.12/site-packages/werkzeug/serving.py", line 362, in run_wsgi
    execute(self.server.app)
    │       │    │      └ <werkzeug.debug.DebuggedApplication object at 0x7f777061a8d0>
    │       │    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7f777064f890>
    │       └ <werkzeug.serving.WSGIRequestHandler object at 0x7f776b7e8320>
    └ <function WSGIRequestHandler.run_wsgi.<locals>.execute at 0x7f776b7ddd00>
  File "/usr/local/lib/python3.12/site-packages/werkzeug/serving.py", line 325, in execute
    for data in application_iter:
                └ <generator object DebuggedApplication.debug_application at 0x7f776b725cc0>
  File "/usr/local/lib/python3.12/site-packages/werkzeug/debug/__init__.py", line 330, in debug_application
    app_iter = self.app(environ, start_response)
               │    │   │        └ <function WSGIRequestHandler.run_wsgi.<locals>.start_response at 0x7f776b7dd300>
               │    │   └ {'wsgi.version': (1, 0), 'wsgi.url_scheme': 'http', 'wsgi.input': <_io.BufferedReader name=7>, 'wsgi.errors': <_io.TextIOWrap...
               │    └ <Flask 'app'>
               └ <werkzeug.debug.DebuggedApplication object at 0x7f777061a8d0>
  File "/usr/local/lib/python3.12/site-packages/flask/app.py", line 1478, in __call__
    return self.wsgi_app(environ, start_response)
           │    │        │        └ <function WSGIRequestHandler.run_wsgi.<locals>.start_response at 0x7f776b7dd300>
           │    │        └ {'wsgi.version': (1, 0), 'wsgi.url_scheme': 'http', 'wsgi.input': <_io.BufferedReader name=7>, 'wsgi.errors': <_io.TextIOWrap...
           │    └ <function Flask.wsgi_app at 0x7f776f3b7380>
           └ <Flask 'app'>
  File "/usr/local/lib/python3.12/site-packages/flask/app.py", line 1455, in wsgi_app
    response = self.full_dispatch_request()
               │    └ <function Flask.full_dispatch_request at 0x7f776f3b6ac0>
               └ <Flask 'app'>
  File "/usr/local/lib/python3.12/site-packages/flask/app.py", line 867, in full_dispatch_request
    rv = self.dispatch_request()
         │    └ <function Flask.dispatch_request at 0x7f776f3b6a20>
         └ <Flask 'app'>
  File "/usr/local/lib/python3.12/site-packages/flask/app.py", line 852, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           │    │           │    │              │    │            └ {'slug': '28-the-shawshank-redemption'}
           │    │           │    │              │    └ 'app_movies.movie_detail'
           │    │           │    │              └ <Rule '/film/<slug>' (GET, HEAD, OPTIONS) -> app_movies.movie_detail>
           │    │           │    └ {'static': <function Flask.__init__.<locals>.<lambda> at 0x7f776de4d300>, 'admin.static': <bound method Blueprint.send_static...
           │    │           └ <Flask 'app'>
           │    └ <function Flask.ensure_sync at 0x7f776f3b6ca0>
           └ <Flask 'app'>
  File "/usr/local/lib/python3.12/site-packages/flask/views.py", line 109, in view
    return current_app.ensure_sync(self.dispatch_request)(**kwargs)
           │                       │    │                   └ {'slug': '28-the-shawshank-redemption'}
           │                       │    └ <function MethodView.dispatch_request at 0x7f776de3bec0>
           │                       └ <app.movies.routes.MovieDetailView object at 0x7f776b7e9c10>
           └ <Flask 'app'>
> File "/usr/local/lib/python3.12/site-packages/flask/views.py", line 190, in dispatch_request
    return current_app.ensure_sync(meth)(**kwargs)
           │                       │       └ {'slug': '28-the-shawshank-redemption'}
           │                       └ <bound method MovieDetailView.get of <app.movies.routes.MovieDetailView object at 0x7f776b7e9c10>>
           └ <Flask 'app'>

  File "/home/app/app/movies/routes.py", line 33, in get
    return render_template('detail_movie.html', movie=movie)
           │                                          └ <Movie 28>
           └ <function render_template at 0x7f776f420cc0>

  File "/usr/local/lib/python3.12/site-packages/flask/templating.py", line 152, in render_template
    return _render(app, template, context)
           │       │    │         └ {'movie': <Movie 28>, 'g': <flask.g of 'app'>, 'request': <Request 'http://127.0.0.1:5000/film/28-the-shawshank-redemption' [...
           │       │    └ <Template 'detail_movie.html'>
           │       └ <Flask 'app'>
           └ <function _render at 0x7f776f4ba3e0>
  File "/usr/local/lib/python3.12/site-packages/flask/templating.py", line 133, in _render
    rv = template.render(context)
         │        │      └ {'movie': <Movie 28>, 'g': <flask.g of 'app'>, 'request': <Request 'http://127.0.0.1:5000/film/28-the-shawshank-redemption' [...
         │        └ <function Template.render at 0x7f776f43e0c0>
         └ <Template 'detail_movie.html'>
  File "/usr/local/lib/python3.12/site-packages/jinja2/environment.py", line 1301, in render
    self.environment.handle_exception()
    │    │           └ <function Environment.handle_exception at 0x7f776f43d940>
    │    └ <flask.templating.Environment object at 0x7f776e0e3b00>
    └ <Template 'detail_movie.html'>
  File "/usr/local/lib/python3.12/site-packages/jinja2/environment.py", line 936, in handle_exception
    raise rewrite_traceback_stack(source=source)
          │                              └ None
          └ <function rewrite_traceback_stack at 0x7f776b7dc7c0>
  File "/home/app/app/templates/detail_movie.html", line 1, in top-level template code
    {% extends 'base.html' %}
  File "/home/app/app/templates/base.html", line 33, in top-level template code
    {% block content %}
  File "/home/app/app/templates/detail_movie.html", line 163, in block 'content'
    {% for mov_similar in movie.get_similar_movie %}
                          │     └ <property object at 0x7f776c114c70>
                          └ <Movie 28>
  File "/usr/local/lib/python3.12/site-packages/jinja2/environment.py", line 485, in getattr
    return getattr(obj, attribute)
                   │    └ 'get_similar_movie'
                   └ <Movie 28>

  File "/home/app/app/movies/models_method.py", line 80, in get_similar_movie
    filtered_movies = Movie.query.filter(Movie.kinopoisk_id.in_(similar_values)).all()
                                                                └ [435, 336, 258048, 468958, 4525, 10851, 463686]

NameError: name 'Movie' is not defined
